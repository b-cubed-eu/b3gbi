<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Biodiversity Indicators Over Space or Time — compute_indicator_workflow • b3gbi</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/PT_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate Biodiversity Indicators Over Space or Time — compute_indicator_workflow"><meta name="description" content="This function provides a flexible framework for calculating various biodiversity
indicators on a spatial grid or as a time series. It prepares the data, creates a grid, calculates indicators,
and formats the output into an appropriate S3 object ('indicator_map' or 'indicator_ts')."><meta property="og:description" content="This function provides a flexible framework for calculating various biodiversity
indicators on a spatial grid or as a time series. It prepares the data, creates a grid, calculates indicators,
and formats the output into an appropriate S3 object ('indicator_map' or 'indicator_ts')."><meta property="og:image" content="https://b-cubed-eu.github.io/b3gbi/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">b3gbi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/b3gbi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://b-cubed.eu/" aria-label="B-Cubed website"><span class="fa fa-cube"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/b-cubed-eu/b3gbi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Biodiversity Indicators Over Space or Time</h1>
      <small class="dont-index">Source: <a href="https://github.com/b-cubed-eu/b3gbi/blob/main/R/workflow_functions.R" class="external-link"><code>R/workflow_functions.R</code></a></small>
      <div class="d-none name"><code>compute_indicator_workflow.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides a flexible framework for calculating various biodiversity
indicators on a spatial grid or as a time series. It prepares the data, creates a grid, calculates indicators,
and formats the output into an appropriate S3 object ('indicator_map' or 'indicator_ts').</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compute_indicator_workflow</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  dim_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"map"</span>, <span class="st">"ts"</span><span class="op">)</span>,</span>
<span>  ci_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"basic"</span>, <span class="st">"perc"</span>, <span class="st">"bca"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  cell_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cube"</span>, <span class="st">"continent"</span>, <span class="st">"country"</span>, <span class="st">"world"</span>, <span class="st">"sovereignty"</span>, <span class="st">"geounit"</span><span class="op">)</span>,</span>
<span>  region <span class="op">=</span> <span class="st">"Europe"</span>,</span>
<span>  ne_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"countries"</span>, <span class="st">"map_units"</span>, <span class="st">"sovereignty"</span>, <span class="st">"tiny_countries"</span><span class="op">)</span>,</span>
<span>  ne_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"medium"</span>, <span class="st">"small"</span>, <span class="st">"large"</span><span class="op">)</span>,</span>
<span>  output_crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  first_year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  last_year <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spherical_geometry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  make_valid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_bootstrap <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  shapefile_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shapefile_crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  invert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_ocean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  buffer_dist_km <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  force_grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data cube object (class 'processed_cube').</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The indicator to calculate. Supported options include:</p><ul><li><p>'obs_richness': Observed species richness.</p></li>
<li><p>'total_occ': Total number of occurrences.</p></li>
<li><p>'newness': Mean year of occurrence.</p></li>
<li><p>'occ_density': Density of occurrences.</p></li>
<li><p>'williams_evenness', 'pielou_evenness': Evenness measures.</p></li>
<li><p>'ab_rarity', 'area_rarity':  Abundance-based and area-based rarity scores.</p></li>
<li><p>'cum_richness': Cumulative species richness.</p></li>
<li><p>'occ_turnover': Occupancy turnover.</p></li>
<li><p>'spec_range': Species range size.</p></li>
<li><p>'spec_occ': Species occurrences.</p></li>
<li><p>'tax_distinct': Taxonomic distinctness.</p></li>
<li><p>'hill0': Species richness (estimated by coverage-based rarefaction).</p></li>
<li><p>'hill1': Hill-Shannon diversity (estimated by coverage-based rarefaction).</p></li>
<li><p>'hill2': Hill-Simpson diversity (estimated by coverage-based rarefaction).</p></li>
</ul></dd>


<dt id="arg-dim-type">dim_type<a class="anchor" aria-label="anchor" href="#arg-dim-type"></a></dt>
<dd><p>Dimension to calculate indicator over (time: 'ts', or space: 'map')</p></dd>


<dt id="arg-ci-type">ci_type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>Type of bootstrap confidence intervals to calculate. (Default: "norm".
Select "none" to avoid calculating bootstrap CIs.)</p></dd>


<dt id="arg-cell-size">cell_size<a class="anchor" aria-label="anchor" href="#arg-cell-size"></a></dt>
<dd><p>Length of grid cell sides, in km. (Default: 10 for country, 100 for continent or world)</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Spatial level: 'cube', 'continent', 'country', 'world', 'sovereignty',
or 'geounit'. (Default: 'cube')</p></dd>


<dt id="arg-region">region<a class="anchor" aria-label="anchor" href="#arg-region"></a></dt>
<dd><p>The region of interest (e.g., "Europe"). (Default: "Europe")</p></dd>


<dt id="arg-ne-type">ne_type<a class="anchor" aria-label="anchor" href="#arg-ne-type"></a></dt>
<dd><p>The type of Natural Earth data to download: 'countries', 'map_units',
'sovereignty', or 'tiny_countries'. (Default: "countries")</p></dd>


<dt id="arg-ne-scale">ne_scale<a class="anchor" aria-label="anchor" href="#arg-ne-scale"></a></dt>
<dd><p>The scale of Natural Earth data to download: 'small' - 110m,
'medium' - 50m, or 'large' - 10m. (Default: "medium")</p></dd>


<dt id="arg-output-crs">output_crs<a class="anchor" aria-label="anchor" href="#arg-output-crs"></a></dt>
<dd><p>The CRS you want for your calculated indicator. (Leave blank
to let the function choose a default based on grid reference system)</p></dd>


<dt id="arg-first-year">first_year<a class="anchor" aria-label="anchor" href="#arg-first-year"></a></dt>
<dd><p>Exclude data before this year. (Uses all data in the cube by default.)</p></dd>


<dt id="arg-last-year">last_year<a class="anchor" aria-label="anchor" href="#arg-last-year"></a></dt>
<dd><p>Exclude data after this year. (Uses all data in the cube by default.)</p></dd>


<dt id="arg-spherical-geometry">spherical_geometry<a class="anchor" aria-label="anchor" href="#arg-spherical-geometry"></a></dt>
<dd><p>If set to FALSE, will temporarily disable spherical geometry
while the function runs. Should only be used to solve specific issues. (Default is TRUE)</p></dd>


<dt id="arg-make-valid">make_valid<a class="anchor" aria-label="anchor" href="#arg-make-valid"></a></dt>
<dd><p>Calls st_make_valid() from the sf package. Increases processing
time but may help if you are getting polygon errors. (Default is FALSE).</p></dd>


<dt id="arg-num-bootstrap">num_bootstrap<a class="anchor" aria-label="anchor" href="#arg-num-bootstrap"></a></dt>
<dd><p>Set the number of bootstraps to calculate for generating
confidence intervals. (Default: 1000)</p></dd>


<dt id="arg-shapefile-path">shapefile_path<a class="anchor" aria-label="anchor" href="#arg-shapefile-path"></a></dt>
<dd><p>Path of an external shapefile to merge into the workflow. For example,
if you want to calculate your indicator particular features such as protected areas or wetlands.</p></dd>


<dt id="arg-shapefile-crs">shapefile_crs<a class="anchor" aria-label="anchor" href="#arg-shapefile-crs"></a></dt>
<dd><p>CRS of a .wkt shapefile. If your shapefile is .wkt and you do
NOT use this parameter, the CRS will be assumed to be EPSG:4326 and the
coordinates will be read in as lat/long. If your shape is NOT a .wkt the CRS
will be determined automatically.</p></dd>


<dt id="arg-invert">invert<a class="anchor" aria-label="anchor" href="#arg-invert"></a></dt>
<dd><p>Calculate an indicator over the inverse of the shapefile (e.g.
if you have a protected areas shapefile this would calculate an indicator over
all non protected areas)</p></dd>


<dt id="arg-include-ocean">include_ocean<a class="anchor" aria-label="anchor" href="#arg-include-ocean"></a></dt>
<dd><p>Include occurrences which fall outside the land area.
Default is TRUE. Set as "buffered_coast" to include a set buffer size around
the land area rather than the entire ocean area.</p></dd>


<dt id="arg-buffer-dist-km">buffer_dist_km<a class="anchor" aria-label="anchor" href="#arg-buffer-dist-km"></a></dt>
<dd><p>The distance to buffer around the land if include_ocean
is set to "buffered_coast".</p></dd>


<dt id="arg-force-grid">force_grid<a class="anchor" aria-label="anchor" href="#arg-force-grid"></a></dt>
<dd><p>Forces the calculation of a grid even if this would not
normally be part of the pipeline, e.g. for time series. This setting is
required for the calculation of rarity, and is turned on by the ab_rarity_ts
and area_rarity_ts wrappers. (Default: FALSE)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to specific indicator calculation functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An S3 object containing the calculated indicator values and metadata.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">diversity_map</span> <span class="op">&lt;-</span> <span class="fu">compute_indicator_workflow</span><span class="op">(</span><span class="va">example_cube_1</span>,</span></span>
<span class="r-in"><span>                                            type <span class="op">=</span> <span class="st">"obs_richness"</span>,</span></span>
<span class="r-in"><span>                                            dim_type <span class="op">=</span> <span class="st">"map"</span>,</span></span>
<span class="r-in"><span>                                            level <span class="op">=</span> <span class="st">"country"</span>,</span></span>
<span class="r-in"><span>                                            region <span class="op">=</span> <span class="st">"Denmark"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diversity_map</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gridded biodiversity indicator map</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Name of Indicator: Observed Species Richness </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Map of Denmark </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: EPSG:4326 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinate range:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      xmin      ymin      xmax      ymax </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8.016236 54.628857 15.483170 57.736914 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grid cell size: 0.25 degrees </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of cells: 387 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation years: 1862 - 2023 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total years with observations: 125 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of species represented: 106 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of families represented: 31 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kingdoms represented: Animalia </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Map layers:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> First 10 rows of data (use n = to show more):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 387 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cellid   area diversity_val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494;">[km^2]</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     68   447.            <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     69   447.            <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     70   447.            20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     71   447.            34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     72   447.            32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     73   447.            34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     74   447.            47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     75   447.            48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     76   447.            37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     77   447.            21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 377 more rows</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shawn Dove.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

