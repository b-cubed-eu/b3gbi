% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_ci.R
\name{add_ci}
\alias{add_ci}
\title{Add Confidence Intervals to an Indicator Object}
\usage{
add_ci(
  indicator,
  num_bootstrap = 1000,
  bootstrap_level = c("cube", "indicator"),
  ci_type = c("norm", "basic", "perc", "bca", "none"),
  trans = function(t) t,
  inv_trans = function(t) t,
  confidence_level = 0.95,
  overwrite = TRUE,
  ...
)
}
\arguments{
\item{indicator}{An object of class \code{indicator_ts} to which confidence
intervals should be added.}

\item{num_bootstrap}{(Optional) Number of bootstrap replicates to perform.
(Default: 1000)}

\item{bootstrap_level}{(Optional) Level at which to perform bootstrapping:
\itemize{
\item \code{cube} (default): Bootstrapping is done by resampling the
occurrence records in the cube. This is mathematically more robust as it
captures the underlying sampling uncertainty.
\item \code{indicator}: Bootstrapping is done by resampling indicator
values. This is faster for large cubes but less robust.
}}

\item{ci_type}{(Optional) Type of bootstrap confidence intervals to
calculate. (Default: \code{"norm"}). Supported options are:
\itemize{
\item \code{norm}: Normal approximation intervals.
\item \code{basic}: Basic bootstrap intervals.
\item \code{perc}: Percentile intervals.
\item \code{bca}: Bias-corrected and accelerated intervals.
\item \code{none}: No confidence intervals calculated.
}}

\item{trans}{(Optional) A function for transforming the indicator values
before calculating confidence intervals (e.g., \code{log}).
(Default: identity function)}

\item{inv_trans}{(Optional) The inverse of the transformation function
\code{trans} (e.g., \code{exp}). Used to back-transform the intervals
to the original scale. (Default: identity function)}

\item{confidence_level}{(Optional) The confidence level for the calculated
intervals (e.g., 0.95 for 95\% CIs). (Default: 0.95)}

\item{overwrite}{(Optional) Logical. If the indicator already contains
confidence intervals (\code{ll} and \code{ul} columns), should they
be replaced? (Default: TRUE)}
}
\value{
An updated object of class \code{indicator_ts} containing the
original data with the following additional columns:
\itemize{
\item \code{ll}: Lower limit of the confidence interval.
\item \code{ul}: Upper limit of the confidence interval.
\item \code{est_boot}: The bootstrap estimate of the indicator value.
\item \code{se_boot}: The bootstrap standard error.
\item \code{bias_boot}: The bootstrap estimate of bias.
\item \code{int_type}: The type of interval calculated (e.g., 'perc').
\item \code{conf}: The confidence level used.
}
}
\description{
This function calculates bootstrap confidence intervals for an existing
\code{indicator_ts} object. It supports both cube-level bootstrapping (resampling
occurrence records) and indicator-level bootstrapping (resampling
calculated values), allowing for advanced transformations during the
CI calculation process.
}
\details{
The function acts as a bridge to the \code{dubicube} package for statistical
heavy lifting. For certain indicators (e.g., Hill numbers), confidence
intervals cannot be added post-hoc as they are calculated internally by
the \code{iNext} package during the initial calculation. In such cases,
a warning is issued and the original object is returned.
}
\seealso{
\code{\link[dubicube:bootstrap_cube]{dubicube::bootstrap_cube()}}, \code{\link[dubicube:calculate_bootstrap_ci]{dubicube::calculate_bootstrap_ci()}}
}
